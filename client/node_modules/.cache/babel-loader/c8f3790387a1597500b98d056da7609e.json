{"ast":null,"code":"import _objectSpread from\"/Users/m.von-buxhoeveden/Desktop/chess_ai_blue_print/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/m.von-buxhoeveden/Desktop/chess_ai_blue_print/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState}from'react';import{Chess}from'chess.js';import{Chessboard}from'react-chessboard';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlayVsRandom(_ref){var boardWidth=_ref.boardWidth;var chessboardRef=useRef();var _useState=useState(new Chess()),_useState2=_slicedToArray(_useState,2),game=_useState2[0],setGame=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),arrows=_useState4[0],setArrows=_useState4[1];var _useState5=useState('white'),_useState6=_slicedToArray(_useState5,2),boardOrientation=_useState6[0],setBoardOrientation=_useState6[1];var _useState7=useState(undefined),_useState8=_slicedToArray(_useState7,2),currentTimeout=_useState8[0],setCurrentTimeout=_useState8[1];function safeGameMutate(modify){setGame(function(g){var update=_objectSpread({},g);modify(update);return update;});}function makeRandomMove(){fetch('/members',{method:'POST',// or 'PUT'\nheaders:{'Content-Type':'application/json'},body:JSON.stringify(game.fen())}).then(function(response){return response.json();}).then(function(actualData){safeGameMutate(function(game){game.move(actualData);});});}function onDrop(sourceSquare,targetSquare){var gameCopy=_objectSpread({},game);var move=gameCopy.move({from:sourceSquare,to:targetSquare,promotion:'q'// always promote to a queen for example simplicity\n});setGame(gameCopy);// illegal move\nif(move===null)return false;// store timeout so it can be cleared on undo/reset so computer doesn't execute move\nvar newTimeout=setTimeout(makeRandomMove,200);setCurrentTimeout(newTimeout);return true;}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Chessboard,{id:\"PlayVsRandom\",animationDuration:200,boardOrientation:boardOrientation,boardWidth:380,customArrows:arrows,position:game.fen(),onPieceDrop:onDrop,customBoardStyle:{borderRadius:'4px',boxShadow:'0 5px 15px rgba(0, 0, 0, 0.5)'},ref:chessboardRef}),/*#__PURE__*/_jsx(\"button\",{className:\"rc-button\",onClick:function onClick(){console.log(game.fen());safeGameMutate(function(game){game.reset();});// stop any current timeouts\nclearTimeout(currentTimeout);console.log(game.fen());if(boardOrientation=='black'){makeRandomMove();};},children:\"reset\"}),/*#__PURE__*/_jsx(\"button\",{className:\"rc-button\",onClick:function onClick(){setBoardOrientation(function(currentOrientation){return currentOrientation==='white'?'black':'white';});if(game.fen()=='rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1'&&boardOrientation=='white'){makeRandomMove();};},children:\"flip board\"}),/*#__PURE__*/_jsx(\"button\",{className:\"rc-button\",onClick:function onClick(){safeGameMutate(function(game){game.undo();});// stop any current timeouts\nclearTimeout(currentTimeout);},children:\"undo\"})]});}","map":{"version":3,"sources":["/Users/m.von-buxhoeveden/Desktop/chess_ai_blue_print/client/src/App.js"],"names":["useRef","useState","Chess","Chessboard","PlayVsRandom","boardWidth","chessboardRef","game","setGame","arrows","setArrows","boardOrientation","setBoardOrientation","undefined","currentTimeout","setCurrentTimeout","safeGameMutate","modify","g","update","makeRandomMove","fetch","method","headers","body","JSON","stringify","fen","then","response","json","actualData","move","onDrop","sourceSquare","targetSquare","gameCopy","from","to","promotion","newTimeout","setTimeout","borderRadius","boxShadow","console","log","reset","clearTimeout","currentOrientation","undo"],"mappings":"iSAAA,OAASA,MAAT,CAAiBC,QAAjB,KAAiC,OAAjC,CACA,OAAQC,KAAR,KAAoB,UAApB,CAEA,OAASC,UAAT,KAA2B,kBAA3B,C,wFAEA,cAAe,SAASC,CAAAA,YAAT,MAAsC,IAAdC,CAAAA,UAAc,MAAdA,UAAc,CACnD,GAAMC,CAAAA,aAAa,CAAGN,MAAM,EAA5B,CACA,cAAwBC,QAAQ,CAAC,GAAIC,CAAAA,KAAJ,EAAD,CAAhC,wCAAOK,IAAP,eAAaC,OAAb,eACA,eAA4BP,QAAQ,CAAC,EAAD,CAApC,yCAAOQ,MAAP,eAAeC,SAAf,eACA,eAAgDT,QAAQ,CAAC,OAAD,CAAxD,yCAAOU,gBAAP,eAAyBC,mBAAzB,eACA,eAA4CX,QAAQ,CAACY,SAAD,CAApD,yCAAOC,cAAP,eAAuBC,iBAAvB,eAEA,QAASC,CAAAA,cAAT,CAAwBC,MAAxB,CAAgC,CAC9BT,OAAO,CAAC,SAACU,CAAD,CAAO,CACb,GAAMC,CAAAA,MAAM,kBAAQD,CAAR,CAAZ,CACAD,MAAM,CAACE,MAAD,CAAN,CACA,MAAOA,CAAAA,MAAP,CACD,CAJM,CAAP,CAKD,CAED,QAASC,CAAAA,cAAT,EAA0B,CAEvBC,KAAK,CAAC,UAAD,CAAc,CAChBC,MAAM,CAAE,MADQ,CACA;AAChBC,OAAO,CAAE,CACP,eAAgB,kBADT,CAFO,CAKhBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAenB,IAAI,CAACoB,GAAL,EAAf,CALU,CAAd,CAAL,CAOAC,IAPA,CAOK,SAACC,QAAD,QAAcA,CAAAA,QAAQ,CAACC,IAAT,EAAd,EAPL,EAQAF,IARA,CAQK,SAACG,UAAD,CAAgB,CACpBf,cAAc,CAAC,SAACT,IAAD,CAAU,CACpBA,IAAI,CAACyB,IAAL,CAAUD,UAAV,EACD,CAFU,CAAd,CAKD,CAdA,EAcE,CAEL,QAASE,CAAAA,MAAT,CAAgBC,YAAhB,CAA8BC,YAA9B,CAA4C,CAE1C,GAAMC,CAAAA,QAAQ,kBAAQ7B,IAAR,CAAd,CACA,GAAMyB,CAAAA,IAAI,CAAGI,QAAQ,CAACJ,IAAT,CAAc,CACzBK,IAAI,CAAEH,YADmB,CAEzBI,EAAE,CAAEH,YAFqB,CAGzBI,SAAS,CAAE,GAAI;AAHU,CAAd,CAAb,CAKA/B,OAAO,CAAC4B,QAAD,CAAP,CAEA;AACA,GAAIJ,IAAI,GAAK,IAAb,CAAmB,MAAO,MAAP,CACnB;AACA,GAAMQ,CAAAA,UAAU,CAAGC,UAAU,CAACrB,cAAD,CAAiB,GAAjB,CAA7B,CACAL,iBAAiB,CAACyB,UAAD,CAAjB,CACA,MAAO,KAAP,CACD,CAED,mBACE,oCACE,KAAC,UAAD,EACE,EAAE,CAAC,cADL,CAEE,iBAAiB,CAAE,GAFrB,CAGE,gBAAgB,CAAE7B,gBAHpB,CAIE,UAAU,CAAE,GAJd,CAKE,YAAY,CAAEF,MALhB,CAME,QAAQ,CAAEF,IAAI,CAACoB,GAAL,EANZ,CAOE,WAAW,CAAEM,MAPf,CAQE,gBAAgB,CAAE,CAChBS,YAAY,CAAE,KADE,CAEhBC,SAAS,CAAE,+BAFK,CARpB,CAYE,GAAG,CAAErC,aAZP,EADF,cAeE,eACE,SAAS,CAAC,WADZ,CAEE,OAAO,CAAE,kBAAM,CACbsC,OAAO,CAACC,GAAR,CAAYtC,IAAI,CAACoB,GAAL,EAAZ,EACAX,cAAc,CAAC,SAACT,IAAD,CAAU,CACvBA,IAAI,CAACuC,KAAL,GACD,CAFa,CAAd,CAGA;AACAC,YAAY,CAACjC,cAAD,CAAZ,CACA8B,OAAO,CAACC,GAAR,CAAYtC,IAAI,CAACoB,GAAL,EAAZ,EACA,GAAIhB,gBAAgB,EAAI,OAAxB,CAAiC,CAC/BS,cAAc,GACiB,EAClC,CAbH,mBAfF,cAgCE,eACE,SAAS,CAAC,WADZ,CAEE,OAAO,CAAE,kBAAM,CAEbR,mBAAmB,CAAC,SAACoC,kBAAD,QAAyBA,CAAAA,kBAAkB,GAAK,OAAvB,CAAiC,OAAjC,CAA2C,OAApE,EAAD,CAAnB,CACA,GAAIzC,IAAI,CAACoB,GAAL,IAAc,0DAAd,EAA4EhB,gBAAgB,EAAI,OAApG,CAA6G,CAC7GS,cAAc,GACmB,EAClC,CARH,wBAhCF,cA4CE,eACE,SAAS,CAAC,WADZ,CAEE,OAAO,CAAE,kBAAM,CACbJ,cAAc,CAAC,SAACT,IAAD,CAAU,CACvBA,IAAI,CAAC0C,IAAL,GACD,CAFa,CAAd,CAGA;AACAF,YAAY,CAACjC,cAAD,CAAZ,CACD,CARH,kBA5CF,GADF,CA4DD","sourcesContent":["import { useRef, useState } from 'react';\nimport {Chess} from 'chess.js';\n\nimport { Chessboard } from 'react-chessboard';\n\nexport default function PlayVsRandom({ boardWidth }) {\n  const chessboardRef = useRef();\n  const [game, setGame] = useState(new Chess());\n  const [arrows, setArrows] = useState([]);\n  const [boardOrientation, setBoardOrientation] = useState('white');\n  const [currentTimeout, setCurrentTimeout] = useState(undefined);\n\n  function safeGameMutate(modify) {\n    setGame((g) => {\n      const update = { ...g };\n      modify(update);\n      return update;\n    });\n  }\n\n  function makeRandomMove() {\n\n     fetch('/members',  {\n        method: 'POST', // or 'PUT'\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(game.fen()),\n      })\n    .then((response) => response.json())\n    .then((actualData) => {\n      safeGameMutate((game) => {\n           game.move(actualData);\n         });\n\n\n    })}\n\n  function onDrop(sourceSquare, targetSquare) {\n\n    const gameCopy = { ...game };\n    const move = gameCopy.move({\n      from: sourceSquare,\n      to: targetSquare,\n      promotion: 'q' // always promote to a queen for example simplicity\n    });\n    setGame(gameCopy);\n\n    // illegal move\n    if (move === null) return false;\n    // store timeout so it can be cleared on undo/reset so computer doesn't execute move\n    const newTimeout = setTimeout(makeRandomMove, 200);\n    setCurrentTimeout(newTimeout);\n    return true;\n  }\n\n  return (\n    <div>\n      <Chessboard\n        id=\"PlayVsRandom\"\n        animationDuration={200}\n        boardOrientation={boardOrientation}\n        boardWidth={380}\n        customArrows={arrows}\n        position={game.fen()}\n        onPieceDrop={onDrop}\n        customBoardStyle={{\n          borderRadius: '4px',\n          boxShadow: '0 5px 15px rgba(0, 0, 0, 0.5)'\n        }}\n        ref={chessboardRef}\n      />\n      <button\n        className=\"rc-button\"\n        onClick={() => {\n          console.log(game.fen())\n          safeGameMutate((game) => {\n            game.reset();\n          });\n          // stop any current timeouts\n          clearTimeout(currentTimeout);\n          console.log(game.fen())\n          if (boardOrientation == 'black') {\n            makeRandomMove()\n                                          };\n        }}\n      >\n        reset\n      </button>\n      <button\n        className=\"rc-button\"\n        onClick={() => {\n\n          setBoardOrientation((currentOrientation) => (currentOrientation === 'white' ? 'black' : 'white'))\n          if (game.fen() == 'rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1' && boardOrientation == 'white') {\n          makeRandomMove()\n                                          };\n        }}\n      >\n        flip board\n      </button>\n      <button\n        className=\"rc-button\"\n        onClick={() => {\n          safeGameMutate((game) => {\n            game.undo();\n          });\n          // stop any current timeouts\n          clearTimeout(currentTimeout);\n        }}\n      >\n        undo\n      </button>\n\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}